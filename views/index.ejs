<%- include('partials/header') %>

<!-- Modernized Hero Carousel -->
<div id="heroCarousel" class="carousel slide carousel-fade hero-modern-carousel" data-ride="carousel">
  <ol class="carousel-indicators">
    <% heroItems.forEach((_, idx) => { %>
      <li data-target="#heroCarousel" data-slide-to="<%= idx %>" class="<%= idx === 0 ? 'active' : '' %>"></li>
    <% }) %>
  </ol>
  <div class="carousel-inner">
    <% heroItems.forEach((item, index) => { %>
      <div class="carousel-item <%= index === 0 ? 'active' : '' %>">
        <div class="carousel-background" style="
          background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.7)),
          url('https://image.tmdb.org/t/p/original<%= item.poster_path %>');
        ">
          <div class="carousel-caption">
            <h1><%= item.title || item.name %></h1>
            <p class="lead">Trending Now</p>
            <a href="/movies/add?tmdbId=<%= item.id %>" class="btn btn-primary">Rate This</a>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
  <a class="carousel-control-prev" href="#heroCarousel" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon"></span>
  </a>
  <a class="carousel-control-next" href="#heroCarousel" role="button" data-slide="next">
    <span class="carousel-control-next-icon"></span>
  </a>
</div>

<!-- Sections for Top Movies, TV, Kids, Not Woke -->
<div class="container categories-container">
  <% const sections = [
    {title: 'Top 5 Most Woke Movies', data: topMovies},
    {title: 'Top 5 Most Woke TV Shows', data: topTV},
    {title: 'Top 5 Most Woke Kids Titles', data: topKids},
    {title: 'Top 5 Not Woke Titles', data: topNotWoke}
  ]; %>

  <% sections.forEach((section, idx) => { %>
    <section class="mt-5">
      <h3 class="section-title"><%= section.title %></h3>
      <div class="scroll-container">
        <% section.data.forEach(item => { %>
          <div class="card modern-card">
            <img src="https://image.tmdb.org/t/p/w500<%= item.posterPath %>" class="card-img-top">
            <div class="card-body">
              <h5><%= item.title %></h5>
              <% if (item.ratings && item.ratings.length) { %>
                <div class="woke-meter">
                  <div class="fill" style="width: <%= (item.averageRating * 10) %>%"></div>
                </div>
                <p class="rating"><%= item.averageRating.toFixed(1) %>/10
                  <% if(item.notWokeCount) { %> - <%= item.notWokeCount %> Not Woke<% } %>
                </p>
              <% } else if(item.notWokeCount) { %>
                <p class="rating"><%= item.notWokeCount %> Not Woke</p>
              <% } else { %>
                <p class="rating">No Ratings Yet</p>
              <% } %>
              <a href="/movies/<%= item._id %>" class="btn btn-outline-primary">View Details</a>
            </div>
          </div>
        <% }) %>
      </div>
    </section>
  <% }) %>
</div>

<%- include('partials/footer') %>
