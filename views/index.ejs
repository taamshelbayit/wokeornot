<% layout('layout') %>

<!-- Hero Banner -->
<div
  class="jumbotron jumbotron-fluid text-light mb-0 hero-banner"
  style="
    background: linear-gradient(45deg, #000 0%, #333 100%);
    min-height: 200px;
  "
>
  <div class="container py-4 text-center">
    <h1 class="display-4 font-weight-bold" style="font-family: 'Bebas Neue', sans-serif;">
      WokeOrNot
    </h1>
    <p class="lead" style="font-family: 'Poppins', sans-serif;">
      Rate the Wokeness of Your Favorite TV Shows & Movies
    </p>
    <% if (!user) { %>
      <a href="/auth/register" class="btn btn-warning btn-lg animated-button">
        Join Now
      </a>
    <% } %>
  </div>
</div>

<!-- "Advanced Search" Button -->
<div class="container mt-3 text-center">
  <a href="/search" class="btn btn-secondary btn-lg">
    Advanced Search
  </a>
</div>

<!-- Trending (limited to 5 in the route) -->
<div class="container mt-4">
  <h3 class="text-warning mb-3" style="font-family: 'Bebas Neue', sans-serif;">
    <i class="fas fa-fire"></i> Trending This Week
  </h3>
  <div class="row">
    <% trending.forEach(item => { %>
      <div class="col-md-3 col-sm-6 mb-4 position-relative" data-aos="fade-up">
        <div class="card h-100 hover-zoom">
          <% if(item.poster_path) { %>
            <img
              src="https://image.tmdb.org/t/p/w500<%= item.poster_path %>"
              class="card-img-top"
              alt="<%= item.title || item.name %>"
            >
          <% } %>
          <span class="badge rating-badge">
            <% if (item.ratings && item.ratings.length > 0 && item.notWokeCount > 0) { %>
              <%= item.averageRating.toFixed(1) %>/10 - <%= item.notWokeCount %> Not Woke
            <% } else if (item.ratings && item.ratings.length > 0) { %>
              <%= item.averageRating.toFixed(1) %>/10
            <% } else if (item.notWokeCount > 0) { %>
              <%= item.notWokeCount %> Not Woke
            <% } else { %>
              No Ratings
            <% } %>
          </span>
          <div class="card-body">
            <h6 class="card-title" style="font-family: 'Poppins', sans-serif;">
              <%= item.title || item.name %>
            </h6>
            <a
              href="/movies/trending/<%= item.id %>"
              class="btn btn-sm btn-outline-warning"
            >
              Rate Now
            </a>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>

<hr class="bg-secondary">

<!-- Top 5 Most Woke Movies -->
<div class="container mt-4">
  <h3 class="text-warning mb-3" style="font-family: 'Bebas Neue', sans-serif;">
    Top 5 Most Woke Movies
  </h3>
  <div class="row">
    <% topMovies.forEach(m => { %>
      <div class="col-md-3 col-sm-6 mb-4 position-relative" data-aos="fade-up">
        <div class="card h-100 hover-zoom">
          <% if(m.posterPath) { %>
            <img
              src="https://image.tmdb.org/t/p/w500<%= m.posterPath %>"
              class="card-img-top"
              alt="<%= m.title %>"
            >
          <% } %>
          <span class="badge rating-badge">
            <% if (m.ratings && m.ratings.length > 0 && m.notWokeCount > 0) { %>
              <%= m.averageRating.toFixed(1) %>/10 - <%= m.notWokeCount %> Not Woke
            <% } else if (m.ratings && m.ratings.length > 0) { %>
              <%= m.averageRating.toFixed(1) %>/10
            <% } else if (m.notWokeCount > 0) { %>
              <%= m.notWokeCount %> Not Woke
            <% } else { %>
              No Ratings
            <% } %>
          </span>
          <div class="card-body">
            <h5 class="card-title"><%= m.title %></h5>
            <a href="/movies/<%= m._id %>" class="btn btn-sm btn-outline-warning">
              View
            </a>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>

<!-- Top 5 Most Woke TV -->
<div class="container mt-4">
  <h3 class="text-warning mb-3" style="font-family: 'Bebas Neue', sans-serif;">
    Top 5 Most Woke TV Shows
  </h3>
  <div class="row">
    <% topTV.forEach(t => { %>
      <div class="col-md-3 col-sm-6 mb-4 position-relative" data-aos="fade-up">
        <div class="card h-100 hover-zoom">
          <% if(t.posterPath) { %>
            <img
              src="https://image.tmdb.org/t/p/w500<%= t.posterPath %>"
              class="card-img-top"
              alt="<%= t.title %>"
            >
          <% } %>
          <span class="badge rating-badge">
            <% if (t.ratings && t.ratings.length > 0 && t.notWokeCount > 0) { %>
              <%= t.averageRating.toFixed(1) %>/10 - <%= t.notWokeCount %> Not Woke
            <% } else if (t.ratings && t.ratings.length > 0) { %>
              <%= t.averageRating.toFixed(1) %>/10
            <% } else if (t.notWokeCount > 0) { %>
              <%= t.notWokeCount %> Not Woke
            <% } else { %>
              No Ratings
            <% } %>
          </span>
          <div class="card-body">
            <h5 class="card-title"><%= t.title %></h5>
            <a href="/movies/<%= t._id %>" class="btn btn-sm btn-outline-warning">
              View
            </a>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>

<!-- Top 5 Most Woke Kids -->
<div class="container mt-4">
  <h3 class="text-warning mb-3" style="font-family: 'Bebas Neue', sans-serif;">
    Top 5 Most Woke Kids Titles
  </h3>
  <div class="row">
    <% topKids.forEach(k => { %>
      <div class="col-md-3 col-sm-6 mb-4 position-relative" data-aos="fade-up">
        <div class="card h-100 hover-zoom">
          <% if(k.posterPath) { %>
            <img
              src="https://image.tmdb.org/t/p/w500<%= k.posterPath %>"
              class="card-img-top"
              alt="<%= k.title %>"
            >
          <% } %>
          <span class="badge rating-badge">
            <% if (k.ratings && k.ratings.length > 0 && k.notWokeCount > 0) { %>
              <%= k.averageRating.toFixed(1) %>/10 - <%= k.notWokeCount %> Not Woke
            <% } else if (k.ratings && k.ratings.length > 0) { %>
              <%= k.averageRating.toFixed(1) %>/10
            <% } else if (k.notWokeCount > 0) { %>
              <%= k.notWokeCount %> Not Woke
            <% } else { %>
              No Ratings
            <% } %>
          </span>
          <div class="card-body">
            <h5 class="card-title"><%= k.title %></h5>
            <a href="/movies/<%= k._id %>" class="btn btn-sm btn-outline-warning">
              View
            </a>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>

<!-- Top 5 Not Woke -->
<div class="container mt-4 mb-4">
  <h3 class="text-warning mb-3" style="font-family: 'Bebas Neue', sans-serif;">
    Top 5 Not Woke Titles
  </h3>
  <div class="row">
    <% topNotWoke.forEach(n => { %>
      <div class="col-md-3 col-sm-6 mb-4 position-relative" data-aos="fade-up">
        <div class="card h-100 hover-zoom">
          <% if(n.posterPath) { %>
            <img
              src="https://image.tmdb.org/t/p/w500<%= n.posterPath %>"
              class="card-img-top"
              alt="<%= n.title %>"
            >
          <% } %>
          <span class="badge rating-badge">
            <% if (n.ratings && n.ratings.length > 0 && n.notWokeCount > 0) { %>
              <%= n.averageRating.toFixed(1) %>/10 - <%= n.notWokeCount %> Not Woke
            <% } else if (n.ratings && n.ratings.length > 0) { %>
              <%= n.averageRating.toFixed(1) %>/10
            <% } else if (n.notWokeCount > 0) { %>
              <%= n.notWokeCount %> Not Woke
            <% } else { %>
              No Ratings
            <% } %>
          </span>
          <div class="card-body">
            <h5 class="card-title"><%= n.title %></h5>
            <p class="text-muted">
              Rating:
              <% if (n.ratings && n.ratings.length > 0) { %>
                <%= n.averageRating.toFixed(1) %>/10
              <% } else { %>
                No Ratings
              <% } %>
            </p>
            <a href="/movies/<%= n._id %>" class="btn btn-sm btn-outline-warning">
              View
            </a>
          </div>
        </div>
      </div>
    <% }) %>
  </div>
</div>
