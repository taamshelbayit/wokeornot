<% layout('layout') %>

<div class="container mt-4">
  <h2>Advanced Search</h2>
  <form action="/search" method="GET" class="form-inline mb-4">
    <!-- Title Field -->
    <div class="form-group mr-3">
      <label for="q" class="mr-2">Title:</label>
      <input type="text" name="q" id="q" class="form-control">
    </div>

    <!-- Type (Movie, TV, Kids) -->
    <div class="form-group mr-3">
      <label for="contentType" class="mr-2">Type:</label>
      <select name="contentType" id="contentType" class="form-control">
        <option value="">Any</option>
        <option value="Movie">Movies</option>
        <option value="TV">TV</option>
        <option value="Kids">Kids</option>
      </select>
    </div>

    <!-- Min Rating -->
    <div class="form-group mr-3">
      <label for="minRating" class="mr-2">Min Woke Rating:</label>
      <input
        type="number"
        name="minRating"
        id="minRating"
        class="form-control"
        min="1"
        max="10"
      >
    </div>

    <!-- Category -->
    <div class="form-group mr-3">
      <label for="category" class="mr-2">Category:</label>
      <select name="category" id="category" class="form-control">
        <option value="">Any</option>
        <option value="Transgender Themes">Transgender Themes</option>
        <option value="Gay Marriage">Gay Marriage</option>
        <option value="Race Swapping">Race Swapping</option>
        <option value="Feminist Agenda">Feminist Agenda</option>
        <option value="Political">Political</option>
        <!-- ... more categories ... -->
      </select>
    </div>

    <button type="submit" class="btn btn-dark">Search</button>
  </form>

  <% if (results) { %>
    <h4>Results</h4>
    <div class="row">
      <% results.forEach(movie => { %>
        <div class="col-md-3 col-sm-6 mb-4 position-relative">
          <div class="card h-100">
            <% if (movie.posterPath) { %>
              <img
                src="https://image.tmdb.org/t/p/w500<%= movie.posterPath %>"
                class="card-img-top"
                alt="<%= movie.title %>"
              >
            <% } %>
            <!-- Rating Badge -->
            <span class="badge rating-badge">
              <%= movie.averageRating.toFixed(1) %>/10
            </span>
            <div class="card-body">
              <h5 class="card-title"><%= movie.title %></h5>
              <a href="/movies/<%= movie._id %>" class="btn btn-primary">
                View
              </a>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>
</div>
